<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHubå®šæ—¶æé†’ç³»ç»Ÿ - è‡ªåŠ¨ä¿å­˜</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        header { background: linear-gradient(135deg, #0088cc, #005a8c); color: white; padding: 25px; text-align: center; }
        .content { padding: 25px; }
        .section { background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 25px; }
        h2 { color: #0088cc; margin-bottom: 20px; }
        input, textarea, button { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; }
        button { background: #0088cc; color: white; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
        button:hover { background: #005a8c; }
        .btn-success { background: #28a745; }
        .btn-warning { background: #ffc107; color: #333; }
        .btn-danger { background: #dc3545; }
        .btn-info { background: #17a2b8; }
        .notification { padding: 15px; border-radius: 5px; margin: 10px 0; display: flex; align-items: center; gap: 10px; }
        .success { background: #d4edda; border-left: 4px solid #28a745; color: #155724; }
        .error { background: #f8d7da; border-left: 4px solid #dc3545; color: #721c24; }
        .info { background: #d1ecf1; border-left: 4px solid #17a2b8; color: #0c5460; }
        .status-indicator { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 5px; }
        .status-online { background: #28a745; animation: pulse 2s infinite; }
        .status-offline { background: #dc3545; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        .action-buttons { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .action-buttons button { flex: 1; min-width: 120px; }
        .toggle-switch { position: relative; display: inline-block; width: 60px; height: 34px; margin-left: 10px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .toggle-slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: #28a745; }
        input:checked + .toggle-slider:before { transform: translateX(26px); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fab fa-telegram"></i> Telegramå®šæ—¶æé†’ç³»ç»Ÿ</h1>
            <p>åŸºäºGitHub Actions | æ”¯æŒè‡ªåŠ¨ä¿å­˜</p>
        </header>
        
        <div class="content">
            <div id="notificationArea"></div>
            
            <!-- è‡ªåŠ¨ä¿å­˜é…ç½® -->
            <div class="section">
                <h2><i class="fas fa-robot"></i> è‡ªåŠ¨ä¿å­˜é…ç½®</h2>
                <div style="margin-bottom: 15px;">
                    <label>
                        <strong>è‡ªåŠ¨ä¿å­˜åŠŸèƒ½ï¼š</strong>
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoSaveToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <span id="autoSaveStatus" style="color:#28a745;">âœ… å·²å¯ç”¨</span>
                    </label>
                </div>
                
                <div id="tokenConfig" style="background: white; padding: 15px; border-radius: 5px; margin: 15px 0;">
                    <h3 style="color:#333; margin-bottom: 10px;">GitHub Token é…ç½®</h3>
                    <p style="color:#666; font-size: 14px; margin-bottom: 10px;">
                        éœ€è¦GitHub Personal Access Tokenæ‰èƒ½è‡ªåŠ¨ä¿å­˜ã€‚<br>
                        <a href="https://github.com/settings/tokens" target="_blank" style="color:#007bff;">ç‚¹å‡»è¿™é‡Œåˆ›å»ºToken</a>
                        ï¼ˆéœ€è¦repoæƒé™ï¼‰
                    </p>
                    <input type="password" id="githubToken" placeholder="è¾“å…¥GitHub Tokenï¼ˆghp_...ï¼‰">
                    <input type="text" id="githubUsername" placeholder="GitHubç”¨æˆ·å" value="xiaowei1110000-cmyk">
                    <input type="text" id="githubRepo" placeholder="ä»“åº“å" value="telegram-reminder">
                    
                    <div class="action-buttons">
                        <button onclick="saveTokenConfig()" class="btn-success">
                            <i class="fas fa-save"></i> ä¿å­˜é…ç½®
                        </button>
                        <button onclick="testAutoSave()" class="btn-info">
                            <i class="fas fa-test"></i> æµ‹è¯•è‡ªåŠ¨ä¿å­˜
                        </button>
                        <button onclick="clearToken()" class="btn-danger">
                            <i class="fas fa-trash"></i> æ¸…é™¤Token
                        </button>
                    </div>
                </div>
                
                <div id="autoSaveInfo" style="color:#666; font-size: 14px; padding: 10px; background: #e9ecef; border-radius: 5px;">
                    <p><i class="fas fa-info-circle"></i> <strong>è‡ªåŠ¨ä¿å­˜è¯´æ˜ï¼š</strong></p>
                    <ul style="margin: 10px 0 0 20px;">
                        <li>å¯ç”¨åï¼Œæ¯æ¬¡æ·»åŠ /åˆ é™¤æé†’éƒ½ä¼šè‡ªåŠ¨ä¿å­˜åˆ°GitHub</li>
                        <li>Tokenä¼šåŠ å¯†ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨</li>
                        <li>éœ€è¦Tokenå…·æœ‰repoæƒé™æ‰èƒ½å†™å…¥ä»“åº“</li>
                    </ul>
                </div>
            </div>
            
            <!-- ç³»ç»ŸçŠ¶æ€ -->
            <div class="section">
                <h2><i class="fas fa-chart-line"></i> ç³»ç»ŸçŠ¶æ€</h2>
                <div id="systemStatus">
                    <p><span class="status-indicator status-offline" id="statusIcon"></span> 
                       <span id="statusText">æ­£åœ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...</span>
                    </p>
                    <p id="nextRunInfo" style="color:#666; font-size:14px; margin-top:5px;"></p>
                    <p id="lastRunInfo" style="color:#666; font-size:14px;"></p>
                </div>
                
                <div class="action-buttons">
                    <button onclick="checkSystemStatus()"><i class="fas fa-sync-alt"></i> åˆ·æ–°çŠ¶æ€</button>
                    <button onclick="viewActionsPage()" class="btn-success"><i class="fab fa-github"></i> æŸ¥çœ‹Actions</button>
                    <button onclick="manualTest()" class="btn-warning"><i class="fas fa-play"></i> æ‰‹åŠ¨æµ‹è¯•</button>
                </div>
            </div>
            
            <!-- æ·»åŠ æé†’ -->
            <div class="section">
                <h2><i class="fas fa-plus-circle"></i> æ·»åŠ æé†’</h2>
                <input type="text" id="reminderName" placeholder="æé†’åç§°ï¼ˆä¾‹å¦‚ï¼šç½‘å®¿IPï¼‰">
                <input type="date" id="lastUpdated">
                <input type="number" id="reminderDays" value="3" placeholder="é—´éš”å¤©æ•°">
                <button onclick="addReminder()" class="btn-success"><i class="fas fa-plus"></i> æ·»åŠ æé†’</button>
            </div>
            
            <!-- æé†’åˆ—è¡¨ -->
            <div class="section">
                <h2><i class="fas fa-list"></i> æé†’åˆ—è¡¨</h2>
                <div id="reminderList"></div>
                <div class="action-buttons">
                    <button onclick="manualSaveToGitHub()" class="btn-success">
                        <i class="fas fa-cloud-upload-alt"></i> æ‰‹åŠ¨ä¿å­˜åˆ°GitHub
                    </button>
                    <button onclick="downloadReminders()" class="btn-warning">
                        <i class="fas fa-download"></i> ä¸‹è½½å¤‡ä»½
                    </button>
                    <button onclick="clearAll()" class="btn-danger">
                        <i class="fas fa-trash"></i> æ¸…ç©ºæ‰€æœ‰
                    </button>
                </div>
            </div>
            
            <!-- GitHubä»“åº“é“¾æ¥ -->
            <div class="section">
                <h2><i class="fab fa-github"></i> GitHubä»“åº“</h2>
                <div style="text-align: center;">
                    <a href="https://github.com/xiaowei1110000-cmyk/telegram-reminder" target="_blank" 
                       style="display: inline-block; padding: 12px 24px; background: #333; color: white; 
                              text-decoration: none; border-radius: 5px; margin: 10px;">
                        <i class="fab fa-github"></i> è®¿é—®ä»“åº“ä¸»é¡µ
                    </a>
                    <a href="https://github.com/xiaowei1110000-cmyk/telegram-reminder/actions" target="_blank"
                       style="display: inline-block; padding: 12px 24px; background: #28a745; color: white; 
                              text-decoration: none; border-radius: 5px; margin: 10px;">
                        <i class="fas fa-play-circle"></i> è¿è¡Œå·¥ä½œæµ
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥è‡ªåŠ¨ä¿å­˜æ¨¡å— -->
    <script src="auto-save.js"></script>
    
    <script>
        let reminders = [];
        let config = {
            autoSave: true,
            githubToken: '',
            username: 'xiaowei1110000-cmyk',
            repoName: 'telegram-reminder'
        };
        let gitHubAutoSave = null;
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('lastUpdated').valueAsDate = new Date();
            loadConfig();
            loadReminders();
            updateReminderList();
            checkSystemStatus();
            
            // åˆå§‹åŒ–GitHubè‡ªåŠ¨ä¿å­˜
            initGitHubAutoSave();
            
            // æ›´æ–°è‡ªåŠ¨ä¿å­˜çŠ¶æ€æ˜¾ç¤º
            updateAutoSaveStatus();
            
            // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡çŠ¶æ€
            setInterval(checkSystemStatus, 60000);
            
            // è®¡ç®—ä¸‹æ¬¡è¿è¡Œæ—¶é—´
            updateNextRunTime();
            
            // è‡ªåŠ¨ä¿å­˜å¼€å…³äº‹ä»¶
            document.getElementById('autoSaveToggle').addEventListener('change', function() {
                config.autoSave = this.checked;
                saveConfig();
                updateAutoSaveStatus();
                
                if (config.autoSave && config.githubToken) {
                    showNotification('âœ… è‡ªåŠ¨ä¿å­˜å·²å¯ç”¨', 'success');
                }
            });
        });
        
        // åˆå§‹åŒ–GitHubè‡ªåŠ¨ä¿å­˜
        function initGitHubAutoSave() {
            if (config.githubToken) {
                gitHubAutoSave = new GitHubAutoSave(
                    config.username,
                    config.repoName,
                    config.githubToken
                );
                
                // æµ‹è¯•è¿æ¥
                gitHubAutoSave.testConnection().then(result => {
                    if (result.success) {
                        console.log('âœ… GitHubè‡ªåŠ¨ä¿å­˜è¿æ¥æ­£å¸¸');
                    } else {
                        console.warn('âš ï¸ GitHubè‡ªåŠ¨ä¿å­˜è¿æ¥å¤±è´¥:', result.error);
                    }
                });
            }
        }
        
        // åŠ è½½é…ç½®
        function loadConfig() {
            const saved = localStorage.getItem('telegramReminderConfig');
            if (saved) {
                const savedConfig = JSON.parse(saved);
                config = { ...config, ...savedConfig };
                
                // æ›´æ–°UI
                document.getElementById('autoSaveToggle').checked = config.autoSave;
                document.getElementById('githubToken').value = config.githubToken || '';
                document.getElementById('githubUsername').value = config.username;
                document.getElementById('githubRepo').value = config.repoName;
            }
        }
        
        // ä¿å­˜é…ç½®
        function saveConfig() {
            // ä»UIè·å–æœ€æ–°å€¼
            config.githubToken = document.getElementById('githubToken').value.trim();
            config.username = document.getElementById('githubUsername').value.trim();
            config.repoName = document.getElementById('githubRepo').value.trim();
            config.autoSave = document.getElementById('autoSaveToggle').checked;
            
            localStorage.setItem('telegramReminderConfig', JSON.stringify(config));
            showNotification('âœ… é…ç½®å·²ä¿å­˜', 'success');
            
            // é‡æ–°åˆå§‹åŒ–è‡ªåŠ¨ä¿å­˜
            if (config.githubToken) {
                initGitHubAutoSave();
            }
        }
        
        // ä¿å­˜Tokené…ç½®
        function saveTokenConfig() {
            const token = document.getElementById('githubToken').value.trim();
            const username = document.getElementById('githubUsername').value.trim();
            const repo = document.getElementById('githubRepo').value.trim();
            
            if (!token) {
                showNotification('è¯·è¾“å…¥GitHub Token', 'error');
                return;
            }
            
            if (!token.startsWith('ghp_') && !token.startsWith('github_pat_')) {
                if (!confirm('Tokenæ ¼å¼å¯èƒ½ä¸æ­£ç¡®ï¼Œæ˜¯å¦ç»§ç»­ä¿å­˜ï¼Ÿ')) {
                    return;
                }
            }
            
            config.githubToken = token;
            config.username = username;
            config.repoName = repo;
            saveConfig();
            
            // æµ‹è¯•è¿æ¥
            testAutoSave();
        }
        
        // æµ‹è¯•è‡ªåŠ¨ä¿å­˜
        async function testAutoSave() {
            if (!config.githubToken) {
                showNotification('è¯·å…ˆé…ç½®GitHub Token', 'error');
                return;
            }
            
            showNotification('æ­£åœ¨æµ‹è¯•GitHubè¿æ¥...', 'info');
            
            const tempGitHub = new GitHubAutoSave(
                config.username,
                config.repoName,
                config.githubToken
            );
            
            const result = await tempGitHub.testConnection();
            
            if (result.success) {
                showNotification(`âœ… è¿æ¥æˆåŠŸï¼ä»“åº“: ${result.repo}<br>æƒé™: ${JSON.stringify(result.permissions)}`, 'success');
                // åˆå§‹åŒ–æ­£å¼å®ä¾‹
                gitHubAutoSave = tempGitHub;
            } else {
                showNotification(`âŒ è¿æ¥å¤±è´¥: ${result.error}`, 'error');
            }
        }
        
        // æ¸…é™¤Token
        function clearToken() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤Tokenå—ï¼Ÿæ¸…é™¤åè‡ªåŠ¨ä¿å­˜å°†å¤±æ•ˆã€‚')) {
                config.githubToken = '';
                document.getElementById('githubToken').value = '';
                saveConfig();
                gitHubAutoSave = null;
                showNotification('âœ… Tokenå·²æ¸…é™¤', 'success');
            }
        }
        
        // æ›´æ–°è‡ªåŠ¨ä¿å­˜çŠ¶æ€æ˜¾ç¤º
        function updateAutoSaveStatus() {
            const statusElement = document.getElementById('autoSaveStatus');
            const isEnabled = config.autoSave && config.githubToken;
            
            if (isEnabled) {
                statusElement.textContent = 'âœ… å·²å¯ç”¨ï¼ˆè‡ªåŠ¨ä¿å­˜ï¼‰';
                statusElement.style.color = '#28a745';
            } else if (config.autoSave && !config.githubToken) {
                statusElement.textContent = 'âš ï¸ å·²å¯ç”¨ï¼ˆæœªé…ç½®Tokenï¼‰';
                statusElement.style.color = '#ffc107';
            } else {
                statusElement.textContent = 'âŒ å·²ç¦ç”¨';
                statusElement.style.color = '#dc3545';
            }
        }
        
        // è‡ªåŠ¨ä¿å­˜åˆ°GitHub
        async function autoSaveToGitHub() {
            if (!config.autoSave || !gitHubAutoSave) {
                return { success: false, message: 'è‡ªåŠ¨ä¿å­˜æœªå¯ç”¨' };
            }
            
            try {
                const jsonData = JSON.stringify(reminders, null, 2);
                const result = await gitHubAutoSave.saveToGitHub(jsonData, 'æ›´æ–°æé†’æ•°æ® [è‡ªåŠ¨]');
                
                if (result.success) {
                    console.log('âœ… è‡ªåŠ¨ä¿å­˜æˆåŠŸ:', result.message);
                    return result;
                } else {
                    console.error('âŒ è‡ªåŠ¨ä¿å­˜å¤±è´¥:', result.error);
                    return result;
                }
            } catch (error) {
                console.error('âŒ è‡ªåŠ¨ä¿å­˜å¼‚å¸¸:', error);
                return {
                    success: false,
                    error: error.message
                };
            }
        }
        
        // æ·»åŠ æé†’ï¼ˆå¸¦è‡ªåŠ¨ä¿å­˜ï¼‰
        async function addReminder() {
            const name = document.getElementById('reminderName').value.trim();
            const lastUpdated = document.getElementById('lastUpdated').value;
            const days = parseInt(document.getElementById('reminderDays').value);
            
            if (!name) {
                showNotification('è¯·è¾“å…¥æé†’åç§°', 'error');
                return;
            }
            
            if (!lastUpdated) {
                showNotification('è¯·é€‰æ‹©æ—¥æœŸ', 'error');
                return;
            }
            
            if (!days || days < 1) {
                showNotification('é—´éš”å¤©æ•°å¿…é¡»å¤§äº0', 'error');
                return;
            }
            
            const reminder = {
                id: Date.now(),
                name: name,
                lastUpdated: lastUpdated,
                days: days,
                createdAt: new Date().toISOString()
            };
            
            reminders.push(reminder);
            saveReminders();
            updateReminderList();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('reminderName').value = '';
            document.getElementById('reminderDays').value = '3';
            document.getElementById('lastUpdated').valueAsDate = new Date();
            
            showNotification(`âœ… "${name}" å·²æ·»åŠ åˆ°æé†’åˆ—è¡¨`, 'success');
            
            // è‡ªåŠ¨ä¿å­˜åˆ°GitHub
            if (config.autoSave && gitHubAutoSave) {
                const saveResult = await autoSaveToGitHub();
                if (saveResult.success) {
                    showNotification('âœ… å·²è‡ªåŠ¨ä¿å­˜åˆ°GitHub', 'success');
                } else {
                    showNotification(`âš ï¸ è‡ªåŠ¨ä¿å­˜å¤±è´¥: ${saveResult.error}`, 'warning');
                }
            }
        }
        
        // åˆ é™¤æé†’ï¼ˆå¸¦è‡ªåŠ¨ä¿å­˜ï¼‰
        async function deleteReminder(id) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæé†’å—ï¼Ÿ')) {
                return;
            }
            
            const reminderName = reminders.find(r => r.id === id)?.name || '';
            reminders = reminders.filter(r => r.id !== id);
            saveReminders();
            updateReminderList();
            
            showNotification(`âœ… "${reminderName}" å·²åˆ é™¤`, 'success');
            
            // è‡ªåŠ¨ä¿å­˜åˆ°GitHub
            if (config.autoSave && gitHubAutoSave) {
                const saveResult = await autoSaveToGitHub();
                if (saveResult.success) {
                    showNotification('âœ… åˆ é™¤åå·²è‡ªåŠ¨ä¿å­˜åˆ°GitHub', 'success');
                }
            }
        }
        
        // æ‰‹åŠ¨ä¿å­˜åˆ°GitHub
        async function manualSaveToGitHub() {
            if (!gitHubAutoSave) {
                showNotification('è¯·å…ˆé…ç½®GitHub Tokenå¹¶æµ‹è¯•è¿æ¥', 'error');
                return;
            }
            
            showNotification('æ­£åœ¨ä¿å­˜åˆ°GitHub...', 'info');
            
            const jsonData = JSON.stringify(reminders, null, 2);
            const result = await gitHubAutoSave.saveToGitHub(jsonData, 'æ‰‹åŠ¨æ›´æ–°æé†’æ•°æ®');
            
            if (result.success) {
                showNotification('âœ… å·²æˆåŠŸä¿å­˜åˆ°GitHub', 'success');
            } else {
                showNotification(`âŒ ä¿å­˜å¤±è´¥: ${result.error}`, 'error');
            }
        }
        
        // æ›´æ–°æé†’åˆ—è¡¨æ˜¾ç¤º
        function updateReminderList() {
            const list = document.getElementById('reminderList');
            
            if (reminders.length === 0) {
                list.innerHTML = '<p style="text-align:center; color:#666; padding:20px;">æš‚æ— æé†’é¡¹ç›®ï¼Œè¯·æ·»åŠ ç¬¬ä¸€ä¸ªæé†’</p>';
                return;
            }
            
            let html = '';
            reminders.forEach(r => {
                const lastDate = new Date(r.lastUpdated);
                const nextDate = new Date(lastDate);
                nextDate.setDate(nextDate.getDate() + r.days);
                const nextStr = nextDate.toLocaleDateString('zh-CN');
                
                const today = new Date();
                const diffDays = Math.ceil((nextDate - today) / (1000 * 60 * 60 * 24));
                
                let status = '';
                if (diffDays <= 0) {
                    status = '<span style="color:#dc3545; font-weight:bold;">ä»Šæ—¥éœ€è¦æé†’</span>';
                } else if (diffDays === 1) {
                    status = '<span style="color:#ffc107; font-weight:bold;">æ˜å¤©æé†’</span>';
                } else {
                    status = `<span>${diffDays}å¤©åæé†’</span>`;
                }
                
                html += `
                    <div style="background:white; padding:15px; margin:10px 0; border-radius:8px; border-left:4px solid #0088cc;">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <div style="flex:1;">
                                <h4 style="margin:0 0 5px 0;">${r.name}</h4>
                                <div style="font-size:14px; color:#666;">
                                    ä¸Šæ¬¡: ${r.lastUpdated} | é—´éš”: ${r.days}å¤© | ä¸‹æ¬¡: ${nextStr}
                                </div>
                                <div style="font-size:13px; margin-top:5px;">${status}</div>
                            </div>
                            <button onclick="deleteReminder(${r.id})" style="background:#dc3545; color:white; border:none; padding:8px 12px; border-radius:5px; cursor:pointer; font-size:14px;">
                                <i class="fas fa-trash"></i> åˆ é™¤
                            </button>
                        </div>
                    </div>
                `;
            });
            list.innerHTML = html;
        }
        
        // å…¶ä»–å‡½æ•°ä¿æŒä¸å˜ï¼ˆcheckSystemStatusã€viewActionsPageã€manualTestç­‰ï¼‰
        function checkSystemStatus() {
            // ... ä¿æŒåŸæœ‰ä»£ç  ...
        }
        
        function viewActionsPage() {
            window.open(`https://github.com/${config.username}/${config.repoName}/actions`, '_blank');
        }
        
        function manualTest() {
            const actionsUrl = `https://github.com/${config.username}/${config.repoName}/actions`;
            showNotification(
                `ğŸ”§ æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤ï¼š<br>
                1. è®¿é—®ï¼š<a href="${actionsUrl}" target="_blank">${actionsUrl}</a><br>
                2. ç‚¹å‡» "Send Telegram Reminder"<br>
                3. ç‚¹å‡» "Run workflow"<br>
                4. ç­‰å¾…è¿è¡Œå®Œæˆ<br>
                5. æ£€æŸ¥Telegramæ¶ˆæ¯`,
                'info'
            );
        }
        
        function downloadReminders() {
            const jsonData = JSON.stringify(reminders, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'reminders-backup.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification('âœ… æé†’æ•°æ®å·²ä¸‹è½½', 'success');
        }
        
        function clearAll() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æé†’å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                reminders = [];
                saveReminders();
                updateReminderList();
                showNotification('âœ… æ‰€æœ‰æé†’å·²æ¸…ç©º', 'success');
                
                // è‡ªåŠ¨ä¿å­˜åˆ°GitHub
                if (config.autoSave && gitHubAutoSave) {
                    autoSaveToGitHub();
                }
            }
        }
        
        function loadReminders() {
            const saved = localStorage.getItem('telegramReminders');
            if (saved) {
                try {
                    reminders = JSON.parse(saved);
                } catch (e) {
                    reminders = [];
                }
            }
        }
        
        function saveReminders() {
            localStorage.setItem('telegramReminders', JSON.stringify(reminders));
        }
        
        function updateNextRunTime() {
            const now = new Date();
            const targetTime = new Date();
            targetTime.setHours(11, 0, 0, 0);
            
            if (now > targetTime) {
                targetTime.setDate(targetTime.getDate() + 1);
            }
            
            const diffMs = targetTime - now;
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));
            
            document.getElementById('nextAutoRun').textContent = 
                `å¤§çº¦ ${diffHours} å°æ—¶ ${diffMinutes} åˆ†é’Ÿå (${targetTime.toLocaleString('zh-CN')})`;
        }
        
        function showNotification(message, type) {
            const notificationArea = document.getElementById('notificationArea');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            let icon = 'fas fa-info-circle';
            if (type === 'success') icon = 'fas fa-check-circle';
            if (type === 'error') icon = 'fas fa-exclamation-circle';
            if (type === 'warning') icon = 'fas fa-exclamation-triangle';
            
            notification.innerHTML = `<i class="${icon}"></i><div>${message}</div>`;
            notificationArea.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode === notificationArea) {
                    notificationArea.removeChild(notification);
                }
            }, 10000);
        }
        
        // å¯¼å‡ºå‡½æ•°åˆ°å…¨å±€
        window.deleteReminder = deleteReminder;
        window.copyToClipboard = copyToClipboard;
    </script>
</body>
</html>
